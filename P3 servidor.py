import numpy as np
from enlace import *
import struct
import time

serialName = "COM3"  

def decodifica(bytes):
    return struct.unpack('b', bytes)[0]

def codifica(numero):
    return struct.pack('b', numero)

def handshake(rxBuffer:bytes):
    com2 = enlace(serialName)
    com2.enable()
    print("Devolvendo o handshake")
    com2.sendData(rxBuffer[1:10])
    return rxBuffer[0]
    
def main():
    try:
        
        print("Iniciou o main no receptor")
        
        com2 = enlace(serialName)
        com2.enable()

        print("esperando 1 byte de sacrifício...")
        rxBuffer, nRx = com2.getData(1)
        com2.rx.clearBuffer()

        print('enviando byte de sacrificio')
        com2.sendData(b'\x00')  # Envia um byte de sacrifício
        com2.rx.clearBuffer()

        print("Aguardando dados...") 
        rxBuffer, nRx = com2.getData(15)
        print("Recebemos {} bytes".format(nRx))
        if(nRx == 15):
            handshake = b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
            handshake += b'\x10\x10\x10'
            tamanho_loop = int.from_bytes(rxBuffer[11:12],'big')
            print("Handshake recebido")
            print(f'esse é o tamanho do loop: {tamanho_loop}')
            com2.sendData(handshake)
            print("Devolvendo Handshake")

        com2.rx.clearBuffer()
        print("Preparado para receber dados")

        #########################################################################################
        payload = b''
        index_do_pacote = 0
        tamanho_payload = 50
        for i in range(tamanho_loop):
            while True:
                len_rx = com2.rx.getBufferLen()
                if len_rx >= 15:
                    rxBuffer, nRx = com2.getData(15+tamanho_payload)
                    tamanho_payload = rxBuffer[3]
                    payload += rxBuffer[12:-3]
                    index_do_pacote = rxBuffer[1]
                    print(f'pacote numero {index_do_pacote} armazenado')
                    time.sleep(0.1)
                    pass

                if index_do_pacote == tamanho_loop:
                    print('rodou todas as vezes o loop')
                    print(f'tamanho do payload (do loop): {len(payload)}')
                    break
            break


        while True:
            len_rx = com2.rx.getBufferLen()
            if len_rx >= 15:
                rxBuffer, nRx = com2.getData(15+tamanho_payload)
                payload += rxBuffer[12:-3]
                index_do_pacote = rxBuffer[1]
                print(f'pacote numero {index_do_pacote} armazenado')
                break
        print(f'tamanho do payload (final): {len(payload)}')
        #########################################################################################

        if payload == b'\xff\xd8\xff\xe0\x00\x10JFIF\x00\x01\x01\x00\x00\x01\x00\x01\x00\x00\xff\xdb\x00\x84\x00\t\x06\x07\x08\x07\x06\t\x08\x07\x08\n\n\t\x0b\r\x16\x0f\r\x0c\x0c\r\x1b\x14\x15\x10\x16 \x1d"" \x1d\x1f\x1f$(4,$&1\'\x1f\x1f-=-157:::#+?D?8C49:7\x01\n\n\n\r\x0c\r\x1a\x0f\x0f\x1a7%\x1f%77777777777777777777777777777777777777777777777777\xff\xc0\x00\x11\x08\x00\x94\x00\xd8\x03\x01"\x00\x02\x11\x01\x03\x11\x01\xff\xc4\x00\x1b\x00\x00\x02\x03\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x05\x00\x02\x04\x01\x06\x07\xff\xc4\x00@\x10\x00\x02\x01\x02\x03\x05\x04\x07\x06\x04\x04\x07\x00\x00\x00\x00\x01\x02\x00\x03\x11\x04\x12!\x131AQa\x05Rq\x91\x14"2B\x81\xa1\xe1\x06b\x92\xb1\xc1\xd1\x15Cr\x82#3\xf0\xf1DSTc\x83\x93\xa2\xff\xc4\x00\x1a\x01\x00\x03\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x02\x03\x00\x04\x05\x06\xff\xc4\x00%\x11\x00\x02\x02\x02\x02\x02\x02\x02\x03\x01\x00\x00\x00\x00\x00\x00\x00\x01\x02\x03\x11\x13\x04\x12!A1R\x14Q"aq\x05\xff\xda\x00\x0c\x03\x01\x00\x02\x11\x03\x11\x00?\x00\xf9e\xa7@\x96\x02w,\xf5\x91\xc3\x92\xb6\x9d\xb4\xb6Y\xdbB\x06T\t\xd0%\x80\x9d\x0b\x19\x00\xad\xa7r\xcbe\x96\xb4 \x07i\xd0\xb0\x81gr\xc2\x0c\x83\x02\\\t`\xb3\xa0Ll\x90\t%\xc2\xce\xe5\x98\r\x94\x92_,\xe6Y\x81\x92\x99o&]!2\xc9\x96`\xe4\x15\xa7\n\xc3d\xbc\x99&6L\xe5g\n\xc3\x95\x95+0r\x07,\xe1\x10\xd9d\xcb\x15\x8c\x00\xac\xe5\xa1\x8a\xca\xe5\x81\x84\x15\xb4\x92\x13,\x91C\x93\x80N\xda\x14,\xeeXE\xc80\xb3\xb9zB\x842\xd9!\x15\xb0\x19e\x82C\x8as\xa2\x9c(\x1d\x80\xec\xe7rM\x01\'BF\x17\xb0\x0c\x92\xc1&\x91NtS\x9b \xecf\xc9:)\xcdB\x94\x9b(2\x07#8I\xdd\x9c\xd3\xb33\xbb3\x0eE\xecd4\xe4\xc95\xec\xe4\xd8\xf4\x9b&\xece\xc9&C6.\x1c\xb6\x83|\x86\x83)\xb3\x03\x7f\x082\x1c\x99\x02I\x97\xa4\xd8)\x0b\xea$4:A\xd892l\xc1\x954f\xcd\x8b\r\xd2\xc2\x9d\xf4#X\x1c\x8d\x91i\xa4eM3\xca48k\xe9me[\nyA\xd9\x0e\x98\xa8\xa1\x93$`\xd8c\x04\xd4H\x83#&b+$\xd4\xd4\xa4\x9b!\xc9ANXS\x9aE)qK\xa4\x1d\x89\xb6f\x14\xe5\x96\x9c\xd4(\xc0\xd5\xa7\x88V\xb2-\xc7Q7te\xe4\xe0\xa7yu\xa5"5q\xfee GI\xa6\x91\xcd\xbdm7s8H\x08\xa5\xd2tR\xe94\xb1E\xde\xe0\x0f\xea\x818\x84\xcd\xea\x97n\x96\xb4\xdd\xc0\xa1&E\xa3.(\xc3\xd0t\xa8\x07\xaa\xc3\xc6jZ\x1d \xd8+\x83F\x11FtP\x8c\x05\x0eb\\P\xe9\x07t\x0e\xac\\(t\x9d\xd8t\x8c\xc6\x1f\xa4\xb7\xa3\xf4\x9bb7F*\xd8t\x93a\xd248~\x92\xc3\r\xd2m\x86\xe8\xc5\x8bD\x8d\xd7\x974\x9d\xed\x9b[n\x8c\xc6\x1b\xa4\xb8\xc3\x8eQ\x1d\x83\xa8\n\xd7\nO\xbb\x0e\x94P%\x8e\x16\x9b7x\xb3~\x862J6\xdd\x0e(/!\x11\xd8QV%4\x00\xf6i\xa2\xfc/\xf9\xcb%\x14km@#\x96[F\xed\x85R4\x12\x87\x0b\xd2&\xcc\x8d\xd0Vp\x89\x98\xe4\xdcg\x1f\x02\xc0z\x9a\xc6~\x8eA\xdd:\xb4lx\xc1\xb0e\x01\rL#\xdfU\x17\x81l#q[\xcfNii\xaa\x83\xe3+\xe8\xf4\xc7\xbb6\xe0\xaa\xcf*\xf8#\xdd"vzW\xa0\x87r\xc96\xf0\xea<\xbd:LV\xe5H7\xdd\n\x8b\xfe F\x16\xeawKze\x1d\x9d\xee\x99\xb8(\x06\xe6e\xab\xdaM\x9a\xd4\xe9 ^\xba\xc3\xdd\x87V}\x1b\x82&\x97e\xd7v\xbb\xe1E\r4\xf2\x88\x9e\xb9\xa8oQu<V@\xee71\xf3\x9b\xb0\x7f\x1cm^\x95E\xbd\xf4\x13\x1bQ\xaa\xd7\xca\x01\xf1\x10*\xef\xde:\xf5\x84\xa2Hm\xfa\xf50w)\x1ap\x0feX6\x83\xe1(hU\x06\xe5Z\xfc\xed\x1faj#e\x0fH\x93\xc5\x83^7\xa1\x85\xc3\xd4OY\x8d\x8f\x02";p?\\z<\x9e\x1e\xa5jV\x17b\xbcA\xe3\x19\xe1k\x92mr\xa3\x97\t\xe8\x17\xb1\xa8\xdf0\x05\x87;M\x14\xbb>\x9a{4\xc7\xc4Ew\n\xe3\x17\xe8]B\x89{\\\x0f\x19\xa1p\xfd#$\xc3\x01\xb9D\xba\xe1\xc7X\xbb\x84\xd5\x91h\xc3\xf4\x96\x18~\x91\x9a\xd2\x04\xd8\x1daF\x1a\xfc&\xdc\r,Q\xe8\xdd$\xf4~\x91\xc8\xc2\xf4\x96\x18@F\xe6\xf2\x83z6\x91(\xa0yN\xec\xad\xee\xc7c\x03\xc4\xb0\x02OC\x03q\xcd\xe16\xe4mLH\xa9c\xa8\x84T\xbf\x08\xd8\xe1G\xbc\x84H((;\xed\xe3\x15\xda\x83\xad\xa1hC\xcb\xe5&\xc5\xcf\xbbx\xdcR[j\xa4\xf8\x11:\xd4\xc3\x0b\x05"#\xb4u\x016\xc9\xafk\x1f)oF\xbf\x08\xcb\xd1N\xfb\x91\rO\x0e\xdc@\xb4Wh\xca\xb1\x1ba\xed\xba\xf0mE\xb8\x0b\xcfAR\x96\xbe\xc8\x95\xd9\xd1\x02\xf5\x05\x871\x17p\xda\xc4\x02\x83[\xd9\x928\xa9W\x0c\xa7(Z\x8cz\x0b\xceA\xb5\x87Q\xf2\x82\xccl\x18\x03n2\x85.yt\x9a\x05>\x90\xabD\xce\x8d\xc7R\xa1\x99\x15\x08\xe0e\x82t\x9b\x96\x8d\xf8\xfc\xa1\x97\x0cy\x18\x8e\xe2\x8b\x8e`J{\xb4\xbc\xdf\x84\xa3\x86\xcc6\xca\xe0t\x86L+\xf2\x86L)\xf7\xa2;\x87\\a\xc7g\x7f\x07Z{6]N\xf2\xdb\xe6\xfd\x96\n\x99\x0e\x8fm\x06R\xa7X\x86\x9e\x15x\x99\xbf\x0fF\x9d?d\\\xceyY\xfd\x8e\xb8\xc33]\xa9\xa9\xd8\xb2\xb0;\xb3p\x85\xa7\x88J\x80_(c\xa6\xfd/\x17\x85?\x08E\xa5},>"M\xdd\x80\xfe"cD\x17:o\x87Z|r\x1bEt\xe9\x947K\xafI\xb6\x8dZ\xa3\x89\x92|\x96\x8d\xf8H=@\xc1\x0eFU#\x8b-\xed1Q\xc5b\x12\xa1\x15}q\xcb-\xa6\xc3^\xb3\x0b\\|D\xb2\xa9\xa8\xa0U`\xd6\xddx\x9f\x94<x\xd1K\xca5aV\x95u\xcc\x18)\xee\x93xJ\xa1W\xf9\xea|\x01\x92\x8e\xcd\x14]\xa9\xdf\xa1\x95\xae\xe7x\xc8OQ2\xe4\x90|u\x92\x86\x921\x07=\xfePo@\xa9\xbd\xed\xe1*q\x04\x1b2\x0f\x84"\xbd6:.\xfer\x8b\x90\xc4|b\x07*,YYOI\rJ\\P|!\nS\xe2V\x05\xe9\xa97\x19L;\xd3\'\xa0\xb0\xa9G\x88\xff\x00\xeau\xaaQ\xb7\xb4|-\x06i\xb2\xfb\xa0i-Is)l\xa6\xddf\xda\x1dE\x0e&\x92\x83\xa5M9)\x96\xa3Q\xeb+d\xa4\xc88\x17\x16\xf9B\r\x98kfPy\t\xd7jT\xf5v\xbf\x11\xa4Whu\xff\x00FZ\xd8l[\\\xab\xd3\xcbn\x1a\x18\xb7\x13C\x19X\xa8\xa7N\xa0Pw\xe6"7n\xd1\xa0\xba\x13\x7f\x84\x1bv\xa5\x10FZe\xbeSm\x92\x1dTc\xc3v]"\x03\xb55\xcc=\xa2\xc7Y\xc9\xa7\xd36\xadkd\x04\xe9\xa4\x90;d6\x93\xe6\x89HC\xa5(T\xa2f\x84\xa2e\xe5i\xde\xaa\x05N\x8br\x9a)\xd2=ai\xd13U:\'\x94\x84\xae(\xaa@\x12\x9f9\xa1),\xd0\x94\xf9\x8b\xcd4\xe9/vFW\x8d\xad#-<2\x9dm5S\xc2\xaf\x043]\x1a\x00\xee\xf9\xcd\x94\xa80]F\x93\x9e\\\x83<!za\x87(d\xa1c\xba0Z=!\x05\x0b\x9d\x04\x84\xb9"vF$\xa1~\x10\xe9C\xa4\xdbO\x0eyM\x14\xf0\xe7\x94\x83\xbd\xbf\x82r\xb5#\x02\xe1\x81\xde\'N\x14_\xd9\x8d\x93\x0cyKz)\xe5\x02v2/\x90\x85A\n\x8be_(7F<#f\xc3[\x84\xa1\xc3\xf3\x10\xab$\x82\xad\x88\xa0\xd1<\xa76\x0c8G\x03\x0e\xbb\xcc\xb6\xc1x\th\xdb#;P\x94Pbno5S\xa2\x9cP\x9f\x84a\xb0\x13\x86\x92\x0e\x026\xe6#\x9af&K-\xb7[u\xe6z\xa6\xa9\xf6H\x8c\xb2\xa8;\x84\xa3\x107\x01\x0e\xe6h\x89\x9a\x8b\xe6-mO\x18:\x98voj\xe7\xc4\xc6\xedP\x8e\x03\xca\x08\xd4\xfb\xb1\x95\xcc\xa2\xff\x00\x04\xe7\x0cyJ\xfa9\x07E\xf2\x11\xbbT\xe4 ^\xa3\x1d\xd1\xd5\xcco"\xd6\xa3R\xda$\x93k3\xf3\x92>\xc0\xe0\xf2i\x87\x07\x94\xd1O\n\x0f(\x911o\xde\x87LS\xf32\x92\xaa\x7f\xb3\xbd8\xb1\xeaaGHe\xc3}\xe1\x11\xa6-\xfb\xed\x0e\xb8\xb7\xef\x99\xcf*\xec\xfd\x87\x08v\x94-\xc4y\xcdT\xd4\x01\xa0Y\xe7\xd7\x16\xdd\xe3\x0c\x98\xa6\xef\x1f9\x19W08d\xf4\x94\xc2\xe9\x9cS\xf2\x9a\x95\xa8\x8d\xf6\x9eYqM\xde0\xc9\x8an\xf1\x9c\xf2\xaad\xe5\xc7\xcf\xb3\xd3\xadJ<\xc4\xba\xba\xdfL\xb3\xcd\xae-\xbb\xc6\x151m\xde\x90\x94f\x89\xbe+==7\xa7\xc4\xeb5R(g\x96\xa7\x8d#\x8c\xd9G\x1e\xc3\x88\x88\xae\x94\x1f\x94r\xd9\xc4\x97\xa3\xd6QT"\x18\xd3[n\x13\xcfa\xfbL\x8fxM\x9f\xc5\xc6^\x13\xda\xe2\xff\x00\xd5\xe2\xc6\xbcX\xbc\x9e|\xf8\xd6\xa6n\xaa\x885\x99\\\xa0\xdd\x16b;H\x92u\x98j\xf6\x83s>s\xcf\xbb\x9d\x1b$\xdc"tW\xc4\x9b\xf9\x1e5A\x06\xd5W\xbd\x10?h?3\xe7\x06{A\xb9\xc8\xed\x9b\xf4t\xae\x1c\x87\xedUy\x98#R#=\xa2\xdc\xe5\x7f\x88\xb7?\x94o\xe6\xc7\\I\x0e\xda\xa4\xa3=\xe2c\xda\x07\x9c\xa1\xed\x0e\xa6:\x8c\xca.4\x87\x05\xba\xc1\x9f\x18\xa4\xe3\xc1\xf7\x8c\xa9\xc7\x0e\xf1\x8e\xa31\xb41\xb1Q\xc4\xca\x15^qQ\xc7\x0e\xf1\x958\xee\xb1\x92\x98t\xb1\xa3\n|I\x9c\x8a\x8e;\xefNC\x89\x1bK>j\xbd\xa8\xa3\x81\x85^\xd7\x03\x81\x88\x83r\x97\x0cg\xd5i\x81\xe4.e\x83\xe5\xed\x85\xe4a\x97\xb6W\x883\xcf+\x19p\xcd\xca#\xe3\xc0\xacy\x96\x1e\x89{e942v\xc2wL\xf3j[\xa4:\x16\xe6$\xdf\x1e\x05\xe3\xcb\xb1\x9e\x91;]94:v\xaa\x1e\r<\xd2\x97\xe94Sg\xe4$%\xc6\x81\xd1\x1eT\xcfH\x9d\xa6\xbc/\x0e\x9d\xa4\'\x9d\xa6\xd5>\xef\x94\xd0\x86\xa9>\xec\xe7\x97\x16\x05\xe3{g\xa1\xa7\x8fS\xc7\xe54\xd3\xc6\x8eby\xfa{^k4\xd3\xda\x8d\xc5O\xf6\xce;8\xb0.\xa7\xdb\xe4~\x98\xeeDC\x1cke\xd0\xc58juY\x85\xc8\xb7\x0fV2|5M\x8d\xf3(\xe8D\xf3\xec\xa6\x11x\x16J\x07\x1f\x1a\xc7\xde\x10\x0f\x8cn\xf2\xcc\xb5Q\xc3{C\xcc~\xd3;-N\xf8\x9d\x15\xf1\xe07\x84mlUOt\xaf\xce\r\xb1U\xf8\ng\xc6\xf3\x11W\xef,\xa1\xda\x0e#\xe1\xfe\xd3\xae4G\x029\x9b\x1b\x15\x89\xeeR\xf3\x80\xa9\x8a\xed\x00\xa4\x8a\x08\xd6\x1b\x95\xb5?9\x99\x8b\x13\xa9\xf9\xfd%\n\xbfx\xcb\xc6\x98\x92\x95\xac\x15n\xd7\xedd$\x0e\xcc{s\xd9\xbc\xc8\xfd\xbf\xdahnpJ\xbe4\xdf\xf7\x9bK8\xf7\xf4\x9c\xdb\xba\xff\x000\tuT>\xa4%l\xbfb\xa6\xfbQ\x8f\x04\x8fF\xa5\xff\x00\xad\xbfy\xc3\xf6\xab\x16?\xe1i\xf90\xfdcS\x89s\xbe\xb2|H\x955\x9c\xfb\xf4\xe3\xeb\xaf\xeaM\xdbg\xd8P\xdfkq+\xedaiy\x99S\xf6\xc2\xbf\x1c-/\xc4cV\xa8x\xec\xcf\xf6\x88&\xc8\xdb\xe9\xd1?\xda\xa7\xf4\x8c\xa1_\xd4Ge\xbfaa\xfbc[\xfe\x92\x9f\xe33\x93}L>\x15\xc5\x9f\t\x87o\xfcbr?J\xbe\xa2l\xbb\xecy1~r\xe0\x1epB\xa4\xb0\xa89\xce\xec\x9erH*\xdf\x8d\xe1W/\x16>p\x0bS\xef,"\xbd\xf8\x03\xd4\x18\x8c\xacp\x1dB\xf0\'\xe5\x0fMy1\xb7\xf4\xfd&U\'\xbaO\x84:\x13\xbb\'\xe4$\xd9x$k\xa6\xbe>_I\xad\x00\xe2\x0e\xee\xbf\xb4\xc3H\xfd\xd6\xf3\xbc\xd3M\xc8\xdfP\x8bpm-9\xe4u\xc3\x06\xb4d\xddu\x16\xe6\x0c\xd1N\xa5;\xd8\x05\xf3\xfa\xcc\x94\xea1\xdfV\xde\x03\xeb5#>\x9e\xbby}$$t\xc4\xd7L#\x1fU\x05\xfco\xfa\xcdT\x01\x16\x16\xd3\xfa~\xb3\x02;\x02\x03\x14\xb8:\x83\xfe\x84\xd9\x85\xc8HU\nI\xd7\xd5?S9,~\x0e\x88\x8e0\x94\xdf@\x07\x84cUj\nZ\x80E\xb9\xcc\x185\xd4\xfa\x8f\xf8\xc9\xbf\xca0w\x02\x9e\\\xc7_wK\xfc\'\x95c\xcc\x89X\xfc\x89\xf1!\xd4\xdfd-\xe5\xf9\xccU*2\x1dP_\xa2\xdf\xf2\x11\x8e,0c\xeb\x857>\xe8\x8b\x99\xeag\xf5\x1du\x1b\xf2\xf1\xf3\x9d\x94\xbf\x05}\x015\xdd\xb4\xd9\x83\xe2\xa4A\xed\x1c\xe9\xb0?\x01\x08\xd5\x181\xbbs\x1a\tCP\xb7\xbc~\r\xf4\x9dq\xff\x00\x04\x92*^\xa0\xd3aP\xf8\x0f\xa4\xad\xdb\xfeQ\xbf]%K\x06\xd7;[\xa1\x07\xf4\x83!\xb7\xed\x0f\xe1\x02Y\x11\x90F\xcd\xc6\x9d\xcf+\xc1\x1b\x8f\xe4\xfc\xef*I\x04\x7f\x8f\xe5*wkQ\xac9\xca"-\x11\x98_\xfc\x87\x1f\xd8L\xe6o\xfbG\xf0\x1f\xdaU\xad\xc1\x8d\x8f\x186\x00nv\xd3v\xb1\xd0\x8d\x04,\x07O\x85\xa0\xcb\x8ec\xf1A\x96\xaa\xba\xed\xdcx\x8d\'v\x95N\xea\xf4\xcf\x8a\xde8\xa4-\x7fe\xaf\xf1\x9d\x94g}\xcd\x90\xf5\xb5\xa4\x98\x07\x90\x06XI$\xeeg\x97\x12\xf0\x80\x0c\xb7\xb4\x92Ee"Z\xf9E\xd7I\x17\x13Pq\x06\xdc\xe7$\x8aW/&\xbaU\xc9\xde\x88|\xe3\n\x16e"\xc4\x01\xc9\x8f\xef$\x92\x13:\xebf\xad\x8a\xd3\xa3\x99I\xd7\x81\x92\x9bX\xa8\x00\x0e2I9\x99\xda\xbd\x0cK\xbd:jQ\xd8h8\xc6(\x8c\xa2\xdbGa}\xcdco\x94\x92N\x0bN\x84\x19q\xf5(\xec\x82\xd2\xa0s\x1d\xe6\x9c`1\xf5*Sr\xc9N\xe0\x0e\x04s\xeb$\x93\x96qX%/\x90\x18\xa3j\xe5\x06\xedx\x9du\x8a\xb1d\xae\x80\x9b\\\x8b\x19$\x8fAU\xf0/\xc4\xd7t\xa8\xaa\x0e\xf9\xc1U\xd9\xb5c\xbeI\'\xa2\x97\x82\r\xf9\x00\xf8\x9a\xb9X\xe6\xe3\x03\xe9\x15Ik\xb9\'t\x92KE\x10\x93*\xd5\xea\x1d3\x1d\xfc\xe73\xbeRs\x19$\x94H\x93eP\xb5B\xd9\x98\xe8O\x19Fw\xd4g6\x12I\x1f\x02\x1df`\t\x0cF\xe9J\x95\\8\x05\x89\xd7y2I\x0f\xa3?\x83\x95\x0b"\x06\x0co\xe3$\x92@\x84l\xff\xd9':
            print('payload está correto!')
        else:
            print('tem algum problema ;-;')

        imagew = "./imgs/imageW.png"
        f = open(imagew, 'wb')
        f.write(payload)

        print("-------------------------")
        print("Comunicação encerrada")
        print("-------------------------")


    except Exception as erro:
        print("ops! :-\\")
        print(erro)
        com2.disable()


if __name__ == "__main__":
    main()
